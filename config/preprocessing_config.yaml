preprocessing:
  pii_detection:
    enabled: true
    strict_mode: true
    
    patterns:
      phone:
        regex: '\b(\+91[\-\s]?)?[6-9]\d{9}\b'
        severity: high
        mask_strategy: last_4_digits
        
      email:
        regex: '\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b'
        severity: high
        mask_strategy: domain_only
        
      pan_card:
        regex: '\b[A-Z]{5}\d{4}[A-Z]\b'
        severity: critical
        mask_strategy: full_mask
        
      aadhaar:
        regex: '\b\d{4}\s?\d{4}\s?\d{4}\b'
        severity: critical
        mask_strategy: full_mask
        
      account_number:
        regex: '\b\d{9,18}\b'
        severity: critical
        mask_strategy: last_4_digits
        
      credit_card:
        regex: '\b\d{4}[\s\-]?\d{4}[\s\-]?\d{4}[\s\-]?\d{4}\b'
        severity: critical
        mask_strategy: last_4_digits
  
  normalization:
    lowercase: true
    remove_extra_spaces: true
    expand_contractions: true
  
  validation:
    min_length: 1
    max_length: 1000
    blocked_characters:
      - '<script>'
      - 'javascript:'
      - 'onerror='
  
  context:
    max_history_length: 5
    session_timeout_minutes: 30
